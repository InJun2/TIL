# 10장

## 10장 견고한 소트웨어를 위한 기술 절차

### 기술 설계 절차
- 기술 설계 절차는 변경사항이 클 경우 그 설계에 대해 모두의 동의를 얻는데 도움이 됨. 설계 업무는 혼자서 업무에 대해 깊이 생각해보는 활동과 그룹이 협력해서 논의하는 활동 등 크게 2가지로 나뉠 수 있고 전자는 조사, 브레인스토밍, 문서 작성 등의 활동으로 이루어지고 후자는 설계에 대해 논의하거나 설계 문서에 의견을 추가하는 등의 활동으로 이뤄진다
- 소프트웨어 설계는 선형적인 과정이 아니며 단독 업무와 팀 협업 사이를 전환하면서 모든 단계마다 설계를 명확히 하고 재정의하는 나선형 업무에 가까움
- 설계문서는 과정을 반복할 때 마다 더 명확하고 상세해지며 실험, 개념 증명, 벤치마크 등 설계 외 업무를 수행하면서 해결책에 대한 문서 작성자의 확신도 커짐
- 설계에 참여하는 인원 수와 다양성도 시간이 지날 수록 증가하며 뒤집어놓은 고깔모양의 바닥에서 시작해서 문제의 범위와 요구사항, 가능한 해결책 등이 불명확한 상태로 절차를 처음 시작할 때는 확실한 해결책 마련이 불가능함
-  이후 고깔의 가장 높은 곳에 도달했다면 설계를 조직에 공유하여 보안, 운영, 조정 팀, 아키텍트 모두가 우리가 제시하는 변경에 대해 알아야함. 단지 피드백을 제공할 뿐만아니라 시스템 동작에 대한 멘탈 모델도 업데이트 해야하기 때문
- 설계가 승인을 받으면 구현이 시작되지만 설계가 완전히 끝난 것이 아님

<br>

### 올바른 기술 설계를 하려면
- 소프트웨어 설계는 탐구에서 출발하여 설계 시작 전 문제 영역과 요구사항을 반드시 이해해야 하고 탐구 과정에는 고민과 조사, 실험, 논의 등이 필요
- 가장 먼저 해결하고자 하는 문제를 정의하고 이해하는 것이 필요. 이해관계자는 문제를 어떻게 보고있는지 물어보는 것 부터 시작하여 여러 이해관계자들로부터 문제에 대한 의견을 수집했다면 피드백을 바탕으로 해당 문제를 명확한 문장으로 정의해야함
    - 문제의 범위에서 어떤 부분이 포함되고 어떤 부분이 포함되는지 각별히 주의
    - 모든 이해관계자들이 생각하는 모든 문제를 하나로 합쳐서 생각하면 안됨
    - 우선 순위가 낮은 변경은 과감히 쳐내도 됨
    - 그 범위를 기술하고 제대로 공유하여 문제를 제대로 이해했는지 확인받고 피드백을 받아야 함
- 주어진 문제를 다시 정의해보면 처음과는 다른 해결책이 보일 것이고 엔지니어는 문제에 집중하고 우선순위를 나열

<br>

### 해결 방법 조사
- 문제를 정의했다고 곧바로 ‘최종’ 설계를 마련하고 서두르면 안됨. 관련 내용에 대한 조사, 다른 해결책, 트레이드 오프등을 생각해봐야 함. 
    - 주로 블로그 게시글을 통해 조사
    - 업계의 컨퍼런스도 확인해야 하는 리소스로 슬라이드 덱이나 녹화된 영상은 주로 온라인에 공개되며 학술 연구와 백서도 잊으면 안됨
    - 우리가 찾고 있는 문제 영역의 전문가와도 상의하자. 사내 전문가에게 피드백을 요청하되 꼭 동료에게만 피드백을 받을 필요는 없음
    - 신중하게 생각하자. 온라인에서 읽는 정보가 모두 좋은 아이디어는 아니며 발생한 문제가 비슷해 보여도 완전히 같지는 않을 수 있다
- 아이디어가 떠올랐다면 대략적으로 코드를 작성하고 테스트를 실행해서 실험해보고 설계상의 트레이드오프를 발견하거나 문제 영역을 더 명확하게 정의할 수 있으며 코드가 어떻게 사용될지에 대한 감각도 얻게되므로 프로토다타입을 팀과 공유해서 피드백을 받아야함
- 이때 실험용 코드에 너무 집착해서는 안되며 개념 증명용 코드는 아이디어를 증명하는 것일 뿐 이후 없애거나 다시 작성하게 되므로 테스트를 작성하거나 코드를 다듬는 데 너무 많은 시간을 허비하지는 말 것 

<br>

### 충분한 시간 투자
- 좋은 설계에는 창의력이 필요하며 앉은 자리에서 한 번에 설계를 끝낼 수 있다고 기대해서는 안되며 자신에게 충분한 시간을 주고 휴식도 취하며 시각을 바꿀 수 있는 환경도 만들어보며 인내심을 가질 것
- 설계는 깊이 생각해야 하며 자신의 집중력이 가장 높아질 시간을 확보해둬라
- 방해로 인한 중단은 높은 집중력을 요하는 업무에 있어 최악의 상황이므로 집중하는 동안에는 어떤 소통도 하지 말아야 함
- 확보한 시간을 전부 설계에만 쏟지말고 휴식도 취하는 것이 좋고, 아이디어는 갑자기 생길 수 있음
- 마감일은 있으므로 설계를 너무 느긋하게 하지는 말고 설계 스파이크를 통해 심사숙고할 수 있는 시간을 마련할 수 있음
    - 스파이크 : 시간제한이 있는 연구 조사를 의미하는 익스트림 프로그래밍으로 스프린트 중에 스파이크 업무를 할당하면 시간 마련이 가능

<br>

### 중요한 변경사항은 문서화
- 설계 문서는 아이디어를 명확하게 소통할 수 있는 확장 방법
- 생각을 정리할 수도 있고 약점이 드러날 수도 있음
- 설계 문서를 작성하려면 가장 중대한 변경사항에 집중하고 목표와 대상을 유념하면서 글쓰기를 연습하고 문서를 계속 업데이트 해야함
- 모든 변경사항에 대해 설계 문서를 작성할 필요는 없으며 중요한 변경사항은 문서화 해두어야 함
- 설계 문서가 필요한지 여부를 알아볼 수 있는 3가지 요소
    - 프로젝트에 최소 한 달이상의 엔지니어링 업무가 필요할 경우
    - 변경사항이 소프트웨어의 확장 및 유지보수에 오랫동안 영향을 미칠 경우
    - 변경사항이 다른 팀에 상당한 영향을 미칠 경우

<br>

### 설계 문서 작성 이유
- 우리가 생각할 수 있게하고 피드백을 받게하며 팀에 새로운 정보를 계속 제공하고 신입 엔지니어의 적응을 도우며 프로젝트 계획을 추진하는데 도움이 됨
- 문서화는 우리가 모르는 것을 드러내는 방법이기도 함. 생각하는 설계를 기록하다 보면 문제 영역을 탐구하면서 생각하는 바를 더 명확하게 정리할 수 있음
- 설계를 문서화하면 피드백 요청하기도 쉬워짐
- 설계 문서는 새로 팀에 합류한 엔지니어에게 특히 유용
- 엔지니어링 관리자와 기술 리드는 설계 문서를 이용해 프로젝트에 대한 계획을 세울 수 있음
- 글쓰는 방법은 꾸준히 배우고 써보는 것이 좋음

<br>

### 설계 문서 최신 상태 유지
- 설계 문서는 최신 상태로 유지해라
- 구현이 시작되면 설계 문서는 소프트웨어 구현 방법을 서술하는 문서로 바뀜
- 제안서에서 문서로 전환되는 과정에서 보편적으로 범하는 실수는 크게 두가지
    - 제안 문서를 더 이상 업데이트하지 않고 내버려 두는 것. 구현 방식은 여러 가지일 수 있으므로 업데이트 하지 않은 문서는 나중에 사용자에게 잘못된 정보를 제공하게됨
    - 문서가 업데이트 되면서 제안 단계에 기록된 이력을 잃어버리는 것. 나중에 합류한 개발자는 그 설계 결정에 이르게 된 논의 과정을 전혀 알 수 없으며 과거의 실수를 반복할 가능성이 커질 수 있음
- 즉 업무를 진행하는 중에 문서를 계속 업데이트해야 하며 코드 리뷰를 수행할 때도 사람들이 계속 문서를 업데이트하는지 독려하고 확인해라
- 설계 문서의 버전도 관리해야 함. 이 경우 설계 문서를 코드와 동일한 리포지토리에서 버전 제어를 수행하는 방식이 좋음

<br>

### 설계 문서 템플릿 구조
- 설계 문서는 현재의 코드 설계, 변경 이유, 고려해 볼 수 있는 여러 해결책과 그중에서 채택하고자 하는 해결책 등을 기술해야 함
- 특히 해결책에는 아키텍처 다이어그램, 주요 알고리즘, 공개 API, 스키마, 대안과의 트레이드오프, 가설, 의존성 등 상세 내용이 모두 담겨 있어야함
- 설계 문서 템플릿의 기본 구조 참조
    - 개요
    - 현재의 상태와 컨텍스트
    - 변경해야 하는 이유
    - 요구사항
        - 사용자 요구사항
        - 기술 요구사항
        - 보안 및 규제 요구사항
        - 기타
    - 고려할 수 있는 해결책
    - 설계와 아키텍처
        - 시스템 다이어그램
        - UI/UX 변경
        - 코드변경
        - API변경
        - 영속 계층 변경
    - 테스트 계획
    - 롤아웃 계획
    - 미결 사항
    - 부록

<br>

### 설계 협업
- 설계 과정에서도 협업은 중요하며 팀과 건설적으로 협업하면 더 나은 설계를 구현할 수 있음
- 그러나 쉽지만은 않으며 개발자는 완고하고 개발자의 피드백을 해석하고 압축해서 의미 있는 설계에 녹여내는 것은 결코 쉬운 일이 아님
- 팀의 설계 절차를 따르고 일찍 자주 소통해서 혼선을 줄이며 설계 논의를 통해 브레인스토밍을 진행하는 등의 방법으로 협업하면서 설계를 완성하자

<br>

### 팀의 설계 리뷰 절차 이해
- 팀의 설계 리뷰 절차를 이해해라. 아키텍트는 설계 리뷰를 통해 앞으로 발생할 거대 변경사항을 알게 되고 기술 리드는 피드백을 제공할 기회를 얻게 됨
- 확고한 리뷰 정책을 운영하는 조직도 있는 반면 비공식적으로 리뷰를 진행하는 조직도 있음. 가장 보편적인 패턴 두 가지는 아키텍처 리뷰 위원회와 의사 결정 요청 절차임
- 아키텍처 리뷰는 좀 더 공식적이며 중요한 절차
    -  설계는 반드시 운영이나 보안 팀같은 다른 이해관계자에 의해 승인을 받아야함
    - 설계 문서도 작성해야 하며 회의나 발표가 여러 번 진행될 수도 있음
    - 아키텍처 리뷰는 시간 비용이 크므로 규모가 크거나 위험도가 높은 변경에 대해서만 진행
    - 최종 승인을 받기까지 코딩을 미뤄서는 안됨. 프로토타입과 개념증명 스파이크를 구현하는데 시간을 들이면 설계에 대한 확신을 높일 수 있으며 프로덕션으로 배포하기까지 시간을 줄일 수 있음
    - 하지만 개념 증명을 넘어서는 수준까지 코딩하는 것은 금물.  설계 피드백에 따라 코드를 변경해야 할 경우가 분명 있을 것이기 때문
- 의사결정 요청은 완전한 리뷰는 필요없지만 어느 정도 논의는 필요한 의사 결정을 빠르게 내려야할 때 팀 내에서 신속하게 수행하는 리뷰 절차
    - 의사결정이 필요한 엔지니어는 간단한 버전의 설계 문서를 작성해서 결정해야 할 사항을 서술
    - 그러면 팀원들이 화이트보드에 그려가며 각자의 선택사항을 논의하고 서로 피드백을 제공하고 의사 결정을 내릴 수 있음

<br>

### 갑작스러운 상황 제거
- 갑작스러운 상황은 만들지 말아라. 사람들에게 설계를 제안할 때는 정중하고 점진적으로 시도하고 정식 설계 문서를 다른 팀이나 기술 리드에게 처음 선보일 때는 실패할 수도 있음을 염두에 두자
- 사전에 미리 언급된적 없는 설계 문서를 갑자기 들이밀면 거부 반응을 보일 수도 있음
- 주로 처음 조사를 시작할 시점에 다른 팀과 기술 리드로부터 일찍이 피드백을 받아보는 것이 좋음
- 피드백 세션을 공식적으로 또는 따로 일정을 잡아 진행할 필요는 없으며 점심 시간, 복도 또는 회의를 시작하기 전 가벼운 대화만으로도 충분함
- 작업의 진행 상황을 사람들에게 계속 공유하자. 업무 보고 회의와 스탠드업 회의에서 계속 업데이트 사항을 제공해야 함
- 향후 변동사항으로 인해 영향을 받을 팀에 미리 알려주어야 함. 특히 지원, QA, 운영 팀이 영향을 받을 확률이 높음
- 포용력을 키워야한다. 여러 사람의 생각을 들을 수 있도록 사람들을 브레인스토밍 세션에 참여시키자

<br>

### 설계 논의 브레인스토밍
- 설계를 논의하며 브레인스토밍 진행. 설계에 대한 논의는 문제 영역에 대한 이해, 지식 공유, 트레이드 오프에 대한 고민, 더 견고한 설계 등에 도움이 됨
- 브레인스토밍 세션은 비공식적이며 자유로운 형태로 대화하는 시간으로 설계에 대한 논의는 문제에 대해서는 어느 정도 이해하고 있지만 설계 방식은 아직 결정되지 않은 시점에 주로 이뤄짐
- 초안이 마련되어 있어도 여러 허점과 답을 찾아야 할 질문들이 여전히 존재하므로 브레인스토밍 과정 중에는 각기 다른 참여자들을 초대해 여러 번 진행하면서 다른 관점에서 설계를 들야다볼 수 있어야 함
- 브레인스토밍 세션은 2~5명 정도의 인원 규모로 이뤄지며 해결해야할 문제가 다면적이거나 논쟁의 여지가 많다면 더 많은 사람을 브레인스토밍에 초대해야 함
- 설계 논의 회의는 2시간 정도로 예약해야 함. 아이디어를 생각해내는 데 시간이 필요하기 때문. 논의를 서둘러 마치기보다는 사람들이 아이디어를 바닥까지 쏟아내거나 지칠 때까지 진행하자. 결론을 내려면 여러 번의 브레인스토밍 세션을 진행해야 할 수도 있음
- 브레인스토밍 세션 시작 전 설계 제안과 더불어 잠재적인 트레이드오프와 아직 해결되지 않은 질문 등 간략하게 회의 안건을 만들어라
- 브레인스토밍 세션에서는 너무 구체화시키려 하지 말것. 사람들이 아이디어에 대해 생각해볼 시간이 필요함
- 브레인스토밍 세션 중 회의 내용을 기록하는 것은 오히려 방해가 될 수 있음. 어떤 팀에서는 회의록을 작성할 사람을 공식적으로 지정하기도 하며 그럴 때는 모든 팀 구성원이 균등하게 해당 역할을 맡게 해야함
- 화이트보드 또한 회의록이 될 수 있으므로 중간중간 상태를 저장해두고 회의가 끝나면 화이트 보드 이미지를 참고해서 간략한 요약본을 작성하고 참여자와 관련 팀원에게 보내주자

<br>

### 설계 참여
- 설계에 참여해라. 우리는 우리의 설계 뿐만 아니라 팀의 설계 업무에도 참여해야 한다
- 우리보다 경험 많은 개발자가 설계를 주도한다면 우리는 설계 문서를 읽고 팀의 설계를 개선하는데 도움이 될 뿐만아니라 다른 배움을 얻을 수 있는 기회도 된다
- 설계에 합류하게 되면 의견은 제안하고 궁금한 것은 물어보자. 코드리뷰와 동일한 가이드라인을 따르면 된다
- 질문하기는 제안 만큼이나 중요하며 질문은 스스로 더 성장하게 된다

<br>

## 책을 통해 느낀점
- 내가 써본 것중에서는 리드미나 위키가 설계 문서라고 이해헀음. 
- 문서화도 항상 하고 있지만 맨날 진행한 마지막에 하는 편이고 지금 발표도 생각나는 경험을 간단하게 적어넣고 진행 중인데 주로 스프링을 통해 프로젝트를 진행할 때 주로 그저 MVC 패턴을 사용하여 구현하여 계층만 분리해서 구현하고 이후 문서화도 한번해보았음.. api v2로 만든 적은 없어서 업데이트를 해본적은 없음.. 이후 설계 문서는 꾸준히 작성해야 할 것 같음
    - 매번 같이 하는 지인과 디스코드를 통해 계속 이야기하며 방향을 왔다갔다하며 사용하는 것 같음. 주로 이슈를 발행해서 해결하는 과정에서 변경되는 것 같음
- 프로젝트 문서화는 해당 템플릿 구조를 참고하여 이후 프로젝트 문서화를 진행하려고 함
    - 그랬는데 프로젝트 회의에 다른 분의 의견을 통해 아래 의견대로 진행해보고자 싶음
- 지금 하는 문서화는 내가 시간이 많아서 진행하고 있다고 생각하는데 앞으로도 크고 작은것 해보려고 해봐야겠음

<br>

## 회의를 통해
- 마크다운이나 아스키를 통한 깃업 저장 방법 추천
- 요구사항이나 변경사항이 있으면 설계를 변경해야하는 경우가 있으므로 설계를 너무 빡빡하게 할 필요는 없을 것 같음
- 주로 템플릿이 아니라 DB 명세서, 시스템 다이어그램 등을 만들어 놓고 해당 과정으로 진행하고 업데이트 진행하고 계시는데 해당 템플릿을 쓰는 것도 좋으나 모든 내용을 계속 인지해야하며 업데이트가 힘들고 관리 툴을 사용하는 것을 추천하심
    - 처음에는 종이와 펜으로 기획을 시작하는 것도 좋음. 관리툴만 배우다 못할 때도 많다고 하심
    - 사용한다면 관리툴은 컨플리어스를 사용하는 것을 추천
- 고려할 수 있는 해결책은 설계 이후 이미 잡혀있다고 생각을 하고 이후 사용할 수있는 방법을 고민해보고 제안해보는 방법도 나쁘지않은 것 같다고 이야기 하심
- 받는 주체에 따라서 문서화를 진행하는 것이 맞는 것 같는 것 같고 변경 사항에 대해 이유에 대해 문서화하는 것이 좋을 것 같음

---

<div style="text-align: right">23-11-08</div>