# 4. 아키텍처

### 독서 중 궁금해지는 내용
- 

<br>

###  연습문제
#### 1. mysql 8.0 에서 쿼리 캐시가 사라진 이유와 다른 성능 최적화를 위한 다른 방법은 무엇이 있는지

<details>
<summary>정답</summary>

- 쿼리 캐시는 SQL 실행 결과를 메모리에 캐시하고 동일 쿼리가 실행되면 결과를 즉시 반환하는 방식이지만 쿼리 캐시의 데이터가 변경되면 변경 관련 테이블을 모조리 삭제해야 했고 이는 심각한 동시 성능 처리 저하가 유발되어 삭제되었음
- 이에 대신 기존 버퍼풀과 인덱스 등을 통하여 주로 성능 개선을 진행함
    - 버퍼풀 관리 : 적절한 버퍼풀 크기를 설정하여 디스크 I/O를 최소화하여 메모리에서 데이터를 효율적으로 관리
    - 인덱스 최적화 : 인덱스를 생성하여 쿼리의 검색 속도를 향상
    - 쿼리 튜닝 : 8.0에서는 개선된 옵티마이저를 사용하여 최적화된 실행 계획을 생성하고 옵티마이저 힌트를 사용하여 실행 계획을 명시적으로 조절 가능
    - 데이터 딕셔너리 캐시 : 8.0에서는 데이터 딕셔너리를 계층 구조로 재구성하여 메타데이터를 관리하고 데이터 딕셔너리 캐시를 도입하여 캐시 미스의 빈도를 줄일 수 있음
    - 스레드 풀 : 기존 스레드를 재사용하여 성능 향상 및 과도한 자원 소모 방지, 다중 스레드를 이용하여 응답 시간 최적화

</details>

<br>

<!-- #### 2. 

<details>
<summary>정답</summary>

- 

</details>

<br> -->

<br>

### 스터디를 진행하면서
- InnoDB 데드락 감지는 타임아웃을 활용하면 자원을 아낄 수 있음
- 성능 측정을 위한 APM 중 Scouter를 통하여 성능을 측정을 진행하고 DB IO bound 문제가 발생했던 적이 있었음
    - https://velog.io/@kmw89891/%EB%B6%80%ED%95%98-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%9A%8C%EA%B3%A0%EB%A1%9D
    - '병목 지점을 찾아서 성능 개선을 위해 사용' 이라는 이유가 중요하다고 느낌
- MySQL InnoDB Adaptive Hash Index
    - https://tech.kakao.com/2016/04/07/innodb-adaptive-hash-index/
- 운영 서버에서 FK를 사용하지 않는 이유
    - Cascade으로 인해서 유지보수성이 떨어진다. (극단적으로, 레코드 삭제시 연관된 데이터가 삭제될 수 있음)
    - 잠금이 여러 테이블로 전파되어 데드락 발생 가능성 증가
    - 부모, 자식 테이블 모두 해당 컬럼에 인덱스 생성
- InnoDB의 장점
    - FK 기능 지원
        - FK 옵션 (foreign_key_checks) 시스템 변수로 일시적 해제 제거 / 
    - MVCC로 인해 잠금을 사용하지 않는 일관적 읽기 제공
        - 자동 데드락 감지
    - 버퍼 풀 사용