# Http Status Code

### Http Status Code
- 사용자가 웹 브라우저를 통해 웹 서버에 어떠한 요청을 할 경우, 웹 서버는 요청에 대한 응답으로 HTTP 상태코드를 나타냄
- 응답은 HTTP 요청이 성공했는지, 실패했는지를 서버에서 알려주는 코드로 5개의 그룹으로 나누어짐
- HTTP 상태 코드를 통해서 사용자는 현재 서버에 어떠한 오류가 있는지 확인할 수 있음

<br>

## 응답코드 종류 
- 아래는 주 응답코드를 간단히 정리. 이 외에도 응답코드 존재
- 클라이언트가 인식할 수 없는 상태코드 반환에도 클라이언트는 3자리 숫자중 첫번째 자리 숫자(상위 상태코드)로 해석해서 처리
- 미래에 새로운 상태 코드가 추가 되어도 클라이언트를 변경하지 않아도 됨

<br><br>

### 1XX : 정보 응답
- 요청이 수신되어 처리중 ( 해당 코드는 거의 사용하지 않음 )

|코드번호|설명|비고|
|:---:|:---:|:---:|
|100|Countinue(진행)|진행 중임을 의미하는 응답코드. 현재까지의 진행상태에 문제 없음|
|101|Switching Protocols(규약전환)|서버에서 프로토콜을 변경할 것을 알려줌. WebSocket 프로토콜 전환 시 사용|
|102|Processing(처리)|서버가 요청을 수신하였고 이를 처리하고 있지만 아직 응답을 알려줄 수 없음|
|103|Checkpoint(체크포인트)|중단된 PUT과 POST 요청을 재개할 목적으로 되찾을 수 있는 request를 사용하는 상태|

<br>

### 2XX : 성공
- 요청을 성공적으로 받았으며 인식했고, 수용함을 의미

|코드번호|설명|비고|
|:---:|:---:|:---:|
|200|OK(성공)|서버가 요청을 제대로 처리했음|
|201|Created(생성됨)|요청이 성공했으며, 새로운 리소스를 만들었음|
|202|Accepted(허용됨)|요청을 받았으나, 아직 처리하지 못했음|
|203|Non-Authoritative Information(권한 없는 정보)|서버가 클라이언트 요구 중 일부만 전송한 상태|
|204|No Content(컨텐츠 없음)|요청을 처리했지만, 컨텐츠를 제공하지 않음(응답 페이로드 본문에 보낼 데이터가 없음)|
|205|Reset Content(컨텐츠 재 설정)|No Content 상태라서 요청자의 요청을 완수한 이후에 사용자 에이전트에게 이 요청을 보낸 문서 뷰를 리셋하라고 알려줍니다|
|206|Partial Content(일부성공)|요청의 일부만 성공적으로 처리(클라이언트의 header 범위 문제로 서버가 자원 일부만 전달받은 상태)|
|207|Multi-Status(다중상태)|멀티-상태 응답은 다수의 리소스가 여러 개의 상태 코드인 상황이 적절한 경우에 해당하는 정보를 서비스에 전달한 상태|
|208|Multi-Status(다중상태)|멀티-상태 응답 DAV에서 사용, propstat(property와 status의 합성어) 응답 속성으로 동일 컬렉션으로 바인드된 복수의 내부 멤버를 반복적으로 열거하는 것을 피하려고 사용하는 상태|
|226|IM Used|서버가 GET 요청에 대한 리소스를 처리했으며, 응답이 하나 또는 그 이상의 인스턴스 조작이 현재 인스턴스에 적용이 되었음을 알리는 상태|

<br>

### 3XX : 리다이렉션
- 요청이 완료되려면 추가 조치 필요

|코드번호|설명|비고|
|:---:|:---:|:---:|
|300|Multiple Choices(여러 선택 항목)|요청에 대해 하나 이상의 응답이 가능. 사용자는 그중 하나를 반드시 선택(쓰지 않음)|
|301|Moved Permanently(영구이동)|요청한 페이지가 다른 위치로 영구 이동, 이전에 보낸 메시지 제거될 수 있음|
|302|Found(임시이동)|요청한 페이지가 다른 위치로 임시 이동. 요청자는 현재 페이지를 요청해야 함(GET), 이전에 보낸 메시지 제거될 수 있음|
|303|See Other(기타위치보기)|리다이렉트시 요청 메서드가 GET으로 변경(302와 기능 유사 요청 메시지 GET으로 변경)|
|304|Not Modified(수정되지 않음)|마지막 요청 이후 요청한 페이지가 수정되지 않음(캐시를 목적으로 사용, 캐시로 리다이렉트)|
|305|Use Proxy(프록시사용)|요청자는 프록시를 사용하여 요청한 페이지만 접근 가능|
|307|Temporary Redirect(임시이동)|리다이렉트시 요청 메서드와 본문 유지(302와 유사, 요청 메서드를 변경하면 안됨)|
|308|Permanent Redirect(영구이동)|리다이렉트시 요청 메서드와 본문 유지(301과 유사하나 라다이렉트전 메시지 유지)|

<br>

### 4XX : 클라이언트 오류
- 요청이 잘못되었거나 요청을 처리할 수 없음

|코드번호|설명|비고|
|:---:|:---:|:---:|
|400|Bad Request(잘못된 요청)|주로 헤더 포멧이 HTTP 규약에 맞지 않을 경우(요청 파라미터가 잘못되거나 API스펙이 맞지 않을 때)|
|401|Unauthorized(권한없음)|인증을 필요로 하는 요청으로 Authentication에 사용|
|402|Payment Required(결제 필요)|이 응답 코드는 나중에 사용될 것을 대비해 예약됨. 첫 목표로는 디지털 결제 시스템에 사용하기 위하여 만들어졌지만 지금 사용되고 있지는 않음|
|403|Forbidden(금지)|서버가 요청을 거부, 요청은 이해했지만 승인 거부(접근권한이 불충분한경우, 금지된 요청을 허가하지 않는 상태)|
|404|Not Found(찾을수없음)|요청한 리소스가 서버에 존재하지 않음|
|405|Method Not Allowed(허용하지 않는 방법)|요청에 지정한 방법을 사용할 수 없음|
|406|Not Acceptable(허용되지 않음)|요청한 페이지를 콘텐츠적 특성으로 인해 응답할 수 없음(request에서 accept header에 not acceptable의 내용을 가진 자원을 요청한 상태)|
|407|Proxy Authentication Required(프록시 인증 필요)|프록시 서버에게 해당 요청이 수행되도록 인증받아야 하는 상태|
|408|Request Timeout(요청시간 초과)|서버의 요청대기가 시간을 초과|
|409|Conflict(충돌)|request 충돌로 인해서 요청이 완료되지 않음|
|410|Gone(사라짐)|요청한 자원이 삭제되었음.과거에는 있었으나 지금은 없는 자원|
|411|Length Required(길이필요)|유효한컨텐츠 길이 명시해야함(Content-Length 부분이 빠져서 요청을 허가하지 않은 상태
)|
|412|Precondition Failed(전제조건실패)|서버에서 요청자가 요청 한 사전 조건을 만족하지 못했을 떄의 응답|
|413|Request entity too large(과도한 요청 entity)|요청이 너무 커서 서버가 처리할 수 없을 때의 응답|
|414|Request-URI Too Long(너무 긴 요청URL)|요청 URI가 너무 긴 상태|
|415|Unsupported Media Type(지원하지 않는 미디어 유형)|지원하지 않는 미디어 타입을 요청한 상태|
|416|Requested Range Not Satisfiable(만족스럽지 않은 요청 범위)|클라이언트가 파일 일부를 요청했을 때 서버가 지원하지 않는 상태|
|417|Expectation Failed(기대실패)|Expect request-header 필드의 요구를 서버가 충족시킬 수 없는 상태|
|421|Misdirected Request(잘못된 요청)|서버로 유도된 요청 응답을 서버에서 생성할 수 없는 상태|
|422|Unprocessable Entity(처리 할수없는 엔티티)|요청은 잘 전달 됐지만, 문법 오류가 난 상태|
|423|Locked(잠김)|요청한 리소스에 접근하는 것이 잠겨있는 상태|
|424|Failed Dependency(의존 실패)|이전의 요청이 실패한 상태에서 지금의 요청도 실패한 상태|
|426|Upgrade Required(업그레이드 필요)|클라이언트에서 보낸 요청의 프로토콜이 맞지 않아 현재 서버에서 처리할 수 없으나, 클라이언트가 다른 프로토콜로 업그레이드한다면 처리의 가능성이 있는 상태|
|428|Precondition Required(전제 조건 필요)|요청이 조건부여야 하는 상태|
|429|Too Many Requests(너무 많은 요청)|사용자가 지정된 시간에 너무 많은 요청을 보낸 상태|
|431|Request Header Fields Too Large(너무 큰 헤더 필드 요청)|요청한 헤드 필드가 너무 커서 서버에서 처리하지 않는 상태|
|451|Unavailable For Legal Reasons(법적 이유로 사용할 수 없음)|정부에 의해 검열된 웹 페이지와 같은 불법적인 리소스를 요청하여 거부된 상태|


<br>

### 5XX : 서버 오류
- 서버가 명백히 유효한 요청에 대해 충족을 실패했음

|코드번호|설명|비고|
|:---:|:---:|:---:|
|500|Internal Server Error(인터넷 서버 오류)|웹 사이트 서버에 문제 존재. 일반적인 서버 에러 메세지로 요청 사항을 이행할 수 없는 상태(서버는 정확한 문제에 대해 구체적 설명 불가(애매한 오류는 모두 500으로 처리))|
|501|Not Implemented(지원 불가)|클라이언트 요청에 대한 서버의 응답 수행 기능이 없음을 의미|
|502|Bad Gateway(잘못된 게이트웨이)|게이트웨이나 프록시의 상태가 나쁘거나 과부화인 상태|
|503|Service Unavailable(서비스 불가)|서버가 요청을 처리할 준비가 되지 않음. 일반적으로 유지보수를 위해 중단되거나 과부하가 걸림|
|504|Gateway Timeout(게이트웨이시간초과)|서버가 게이트 웨이 역할을 하고 있으며 한 서버가 엑세스하고 있는 다른 서버에 적시에 응답을 받지 못했음|
|505|HTTP Version Not Supported(HTTP버전 미지원)|서버가 요청에 사용된 HTTP 프로토콜 버전을 지원하지 않음|
|506|Variant Also Negotiates(변형 협상)|서버 내부 값에 오류가 있어 반환되는 값에 컨텐츠 협상이 순환 참조로 이루어져 있음을 알림|
|507|Insufficient Storage(저장소 부족)|서버내부 값에 오류가 있어 협상 과정에서 적절한 끝점이 아님|
|508|Loop Detected(루프 감지)|서버가 요청을 처리하는 동안 무한 루프를 발견|
|510|Not Extended(확장되지않음)|서버가 요청을 처리할때 요청에 대한 추가 확장이 필요함|
|511|Network Authentication Required(네트워크 인증 요구)|사용자가 네트워크 엑세스 권한이 필요한 경우|

<br>

### Redirect?
- 웹 브라우저는 3xx 응답의 결과에 Location 헤더가 있으면, Location 위치로 자동 이동 ( 리다이렉트 )
- 영구 리다이렉션 : 특정 리소스의 URI가 영구적으로 이동
    - 특정 리소스의 URI가 영구적으로 이동되는 경우
    - 원래의 URI를 아예 사용하지 않게 된다. 검색 엔진 등에서도 이를 인지하게 된다.
    - 301 (Moved Permanently) : 리다이렉트 시 요청 메서드가 GET으로 변하고 본문이 제거될 수 있음
        - 이벤트창에서 POST로 본문을 전달하는 과정에서 리다이렉트되면, 다시 작성해야 함
        - URL리소스가 변경되었다는 것은 Form 양식 같은 것이 변경되었을 가능성이 크기 때문에 새롭게 다시 입력을 받아야만 하기 때문에 301을 많이 사용
    - 308 (Permanent Redirect) : 301과 기능은 같지만 요청 메서드와 본문이 유지된다.
    - 실무에서 더 많이 쓰이는 것은 301이다. 영구 리다이렉션을 할 경우 폼이 변경되는 경우가 많아 요청 메서드와 본문을 그대로 유지하는 경우가 적기 때문이다
- 일시 리다이렉션 : 일시적인 변경 (PRG: Post/Redirect/Get)
    - 특정 리소스의 URI가 일시적으로 변경되는 경우
    - 검색 엔진 등에서 URI가 변경되지 않음
    - 기능은 영구 리다이렉션과 같지만 일시적임에 유의해야 한다.
    - 302 (Found) : 리다이렉트 시 요청 메소드가 GET으로 변하고 본문이 제거될 수 있음
    - 307 (Temporary Redirect) : 302와 기능은 같지만 요청 메서드와 본문이 유지된다.
    - 303 (See Other) : 302와 기능은 같지만 요청 메서드가 고정적으로 GET으로 변경된다.
    - PRG (Post/Redirect/Get) : 일시 리다이렉션의 예로, Post 후 Get으로 리다이렉트하는 것을 뜻한다. Post로 주문 요청 후 새로고침을 수행했을 때 중복 주문이 발생하는 것을 방지한다. Get으로 결과화면을 리다이렉트함으로써, 새로고침을 해도 결과화면만 요청되도록 한다.
    - RPG 를 사용하지 않는다면 : POST로 주문 후에 웹 브라우저 새로고침하면? -> 새로 고침은 다시 요청, 중복 주문이 될 수 있음
    - RPG : POST로 주문후에 새로 고침으로 인한 중복 주문 방지 -> POST로 주문후에 주문 결과 화면을 GET 메서드로 리다이렉트 -> 새로고침해도 결과 화면을 GET으로 조회 -> 중복 주문 대신에 결과 화면만 GET으로 다시 요청
    * 처음 302 스펙의 의도는 HTTP 메서드를 유지하는 것이었으나 웹 브라우저들이 대부분 GET으로 바뀌어서 대신 명확한 303, 307 등장 (303,307을 권장하나 대부분의 애플리케이션은 302 사용중)
- 특수 리다이렉션 : 결과 대신 캐시 사용
    - 캐시를 목적으로 사용
    - 클라이언트에게 리소스가 수정되지 않았음을 알려줌
    - 따라서 클라이언트는 로컬 PC에 저장된 캐시를 재사용함

<br>

<br/>

## Ssafy Wizards CS Study

<br>

### 1. 401 (Unauthorized) 와 403 (Forbidden)의 의미적인 차이
- 401 (Unauthorized) 응답코드는 클라이언트 인증이 되지 않아 인증을 필요로 하는 요청으로 Authentication에 사용하는 응답코드
    - 아직 로그인을 하지 않았을 때 로그인된 사용자만 접근 가능한 페이지를 요청할 경우
- 403 (Forbidden) 응답코드는 요청은 받아들였지만 접근권한이 불충분하여 서버가 클라이언트의 요청을 거부하었을 때 응답 코드
    - 인증된 사용자이지만 일반 유저 로그인 정보로 관리자 페이지에 접근할 경우 접근 권한이 없어 발생

<br>

### 2. 200 (ok) 와 201 (created) 의 차이
- 200 (ok) 상태코드는 클라이언트의 요청이 성공적으로 처리되었을 때를 의미
- 201 (create) 상태코드는 클라이언트의 요청이 성공적으로 처리되었고 해당 결과로 새로운 리소스가 생성되었음을 의미

<br>

### 3. 필요하다면 저희가 직접 응답코드를 정의해서 사용할 수 있는지
- 일반적으로 HTTP 프로토콜은 이미 다양한 상황에 맞는 표준 응답 코드를 정의하고 있어 해당 응답 코드를 사용하는 것이 다른 개발자나 시스템 이해에 용이하며 혼란을 줄일 수 있어 권장됨
- 서버 내에서의 처리 결과가 표준 응답 코드 중에서 적절한 것이 없거나 특정 비즈니스 로직을 명확하게 나타내기 위해 커스텀 코드를 사용할 수 있음
- 커스텀 응답코드의 경우 다른 API 와 호환되지 않으므로 명확한 문서화가 필수적
- 또한 커스텀 응답코드가 기존 응답코드와 충돌하지 않도록 기존 응답코드가 사용하지 않는 범위의 코드를 사용하는 것이 좋음

<br>

<div style="text-align: right">22-11-08</div>

-------

## Reference
- https://velog.io/@sangyeon217/http-status-code
- http://www.incodom.kr/Status_code