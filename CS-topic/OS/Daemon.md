# Daemon

### Daemon?
- 데몬이란 서비스의 요청에 대해 응답하기 위해 오랫동안 실행중인 백그라운드 프로세스
- 유닉스 운영체제에서 이름이 "d"로 끝나는 프로세스들이 대표적이라고 함
    - inetd, httpd, nfsd, sshd, named, lpd
- 서버는 계속 멈추지 않고 클라이언트의 요청을 처리하는데 이와 같이 멈추지 않고 계속 작동하는 프로그램을 데몬(deamon)이라고 함
    - 웹 대몬으로 많이 사용되는 소프트웨어는 IIS, 아파치 톰캣 등

<br>

### CGI(Common Gateway Interface)와 가상머신
- 초기 HTML 화면은 고정된 페이지로 구성되어 동적인 데이터를 표시하는 것이 안됬으나 동적인 데이터를 HTML에 삽입하려면 프로세스에 질문하고 결과값을 HTML 형태로 웹 데몬에 전달하는 프로세스가 필요했는데 이를위해 개발된 것이 CGI
    - 초기의 CGI는 C, 펄, 오크 같은 프로그래밍언어를 사용해 간단한 작업만이 가능하였으나 웹 시스템이 발전하면서 많은 작업을 웹에서 하게 되었음
- 그에따라 데이터베이스와 웹 서버의 연결 작업에 CGI를 사용하기 시작
    - 대표적인 예로 ASP, PHP, JSP가 있음
- 클라이언트/서버 시스템이 발전함에 따라 미들웨어 개념도 등장
    - 미들웨어 : 양쪽을 연결하여 데이터를 주고받을 수 있도록 중간에서 매개 역할을 하는 소프트웨어
    - 미들웨어를 사용하는 클라이언트/서버를 3-tire 클라이언트/서버, 사용하지 않는 클라이언트/서버를 2-tire 클라이언트/서버라고 함
- 운영체제와 관련된 미들웨어로는 가상머신이 있으며 객체지향언어인 자바는 다른 운영체제에서도 코드 수정없이 사용할 수 있도록하는 자바 가상 머신(JVM)이 존재

<br>

### BackGround Process?
- 포그라운드(Foreground) 프로세스의 반대 개념으로 입력장치에 대해 터미널과의 관계를 끊은 모든 프로세스를 의미
    - 포그라운드 프로세스는 표준입출력장치를 통해 대화하는 프로세스

<br>

### 자바의 데몬 스레드
- 스레드는 일반 스레드와 데몬 스레드가 존재
- JVM 이 처음 시작할 때 main 스레드를 제외하고 JVM 내부적으로 사용하기 위해 실행하는 스레드(가비지 컬렉터 스레드나 기타 여러 부수적인 스레드)는 모두 데몬 스레드
- 새로운 스레드가 생성되면 자신을 생성해 준 부모 스레드의 데몬 설정 상태를 확인해 그 값을 그대로 사용하며, 따라서 main 스레드에서 생성한 모든 스레드는 기본적으로 데몬 스레드가 아닌 일반 스레드임
    - 스레드 내부적으로 데몬 상태 존재
- 스레드 하나가 종료되면 JVM 은 남아있는 모든 스레드 가운데 일반 스레드가 있는지를 확인하고, 일반 스레드는 모두 종료되고 남아있는 스레드가 모두 데몬 스레드라면 즉시 JVM 종료 절차를 진행
    - finally 블록의 코드도 실행되지 않으며, 호출 스택도 원상 복구되지 않음
    - 데몬 스레드에 사용했던 자원을 꼭 정리해야 하는 일을 시킨다면, JVM이 종료될 때 자원을 정리하지 못할 수 있기 때문에 적절하지 않음
    - 데몬 스레드는 예고 없이 종료될 수 있기 때문에 앱 내부에서 시작시키고 종료하기에는 그다지 좋은 방법이 아님

<br>

<div style="text-align: right">24-04-22</div>

-------

## Reference
- https://blogger.pe.kr/770
- https://github.com/InJun2/TIL/blob/main/BookStudy/SE/쉽게배우는운영체제/Chapter12.md