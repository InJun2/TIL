# RDB vs NoSQL

### NoSQL 등장 배경
- RDB를 이용하여 과거에 데이터 구조가 단순하고 정적이전 시절부터 사용하여 40년 이상 사용되어짐
- 하지만 기술과 빅데이터 응용 프로그램이 발전함에 따라 기존의 SQL 기반 관계형 데이터베이스는 빠르게 확장되는 데이터의 양과 점점 복잡해지는 데이터 구조 처리 능력이 부족
- 약 10년 동안 NoSQL 데이터베이스는 기존의 SQL 기반의 관계형 데이터베이스에 비해 유연하고, 확장가능하며, 비용적으로 효율적인 대안을 제공하기 위해 사용됨

<br>

### RDB (Relational Database)
- 관계형 모델을 기반으로 하는 데이터베이스
- 사전에 엄격하게 정의된 스키마를 요구하는 테이블 기반 데이터 구조를 가짐
- 관계는 각 데이터를 중복없이 한번만 저장
- 스키마 구조를 변경하는 것은 시간이 많이 들고 고비용이며 종종 중단 시간이나 서비스 중단이 발생할 수 있음
- 테이블 기반으로 이루어짐 -> 다른 테이블들과 관계를 맺고 모여있는 집합체
- 스케일링에서 수직확장이 가능하나 확장을 위해서는 전체 데이터베이스를 호스팅하기 위한 단일 서버가 필요하므로 더 크고 비싼 서버를 구입해야해 고비용 -> 수평적 확장이 가능하나 데이터가 늘어날 수록 수평적 확장에 대한 관리가 복잡
    - RDB도 수평적 확장이 가능하나 ACID와 Transaction을 보장하기 위해 수평적 확장이 쉽지 않다고 함. 또한 muliple server로 수평적 확장을 하게 되면 join을 하기위해 굉장히 복잡한 과정이 필요 -> RDB를 수평적 확장하려면 샤딩이 필요하다고 함 (ACID를 준수 유지하며 RDB 샤딩하는 것은 매우 까다로움)

<br>

### NoSQL
- NoSQL 데이터베이스에는 사전에 정의된 스키마가 필요하지 않으므로 동적 스키마라는 특징을 가지고 <code>비정형 데이터</code>를 다룰때 자유롭게 작업 가능
- 사전 정의된 스키마가 없어 데이터를 갱신하거나 변경하는 것이 단순
- 데이터는 애플리케이션이 필요로 하는 형식으로 저장하여 데이터를 읽어오는 속도가 빨라짐
- 수직 및 수평 확장에 유용하여 데이터베이스가 애플리케이션에서 발생하는 모든 읽기/쓰기 요청을 처리 할 수 있음
- 비관계형 데이터베이스로 document based, graph databases, key-value pairs, wide-colum stores 일 수 있음
- 수직 확장도 가능하고, 수평 확장으로 저렴한 범용 서버를 이용해 수평 확장함으로써 용량을 추가할수 있어 매우 저렴 -> 수평 확장에 유용

```
비정형 데이터 
- 식별 가능한 구조나 아키텍처가 없는 데이터
- 특정 스키마가 포함되지 않아 매우 유연. 다양한 데이터 포맷 사용 가능
- 특정 데이터 검색과 기존 소프트웨어 도구 분석 매우 어려움 
- 정형 데이터는 데이터 웨어하우스를 이용해 저장하지만 비정형 데이터는 데이터 레이크가 사용됨

스케일 업(Scale Up)
- 물리적인 성능 향상
- 고비용, 고효율
- 수직 스케일링 (vertical scailing)
- 단순하거나 빠른 작업(DB갱신 자주 일어나야 하는 경우)에 적합
- 데이터 정합성 이슈 발생 가능성이 적음
- 성능 향상의 한계가 있고 서버가 분담하는 양이 많아져 문제가 생기면 치명적
- 서버 교체나 업그레이드 시에 서비스 이용이 어려울 수 있음

스케일 아웃(Scale Out)
- 비슷한 사양의 서버를 추가로 연결
- 데이터 분석처럼 복잡한 작업에 더 적합
- 수평 스케일링 (horizontal scailing)
- 확장에 용이 (확장의 유연성, 단계적인 확장 가능)
- 확장 비용이 상대적으로 적음
- 관리하기 어렵고 관리비용이 많이듬. 로드밸런싱이 필요
- 데이터 정합성 이슈 발생 가능성이 커짐 (모든 서버에서 일관성 유지해야 하므로)
```

<br>

### NoSQL 장점
- #### 유연한 데이터 모델
    - 유연하며 자유로운 데이터 구조를 가질 수 있음
    - 언제든 저장된 데이터를 조정하고 새로운 필드 추가 가능
    - 요구사항이 변경되었을 때 데이터베이스를 쉽게 변경 가능
- #### 수평정 확장
    - 대부분의 SQL 데이터베이스는 현재 서버에서 요구되는 용량을 초과하면 수직적 확장(크고 비싼 서버로 마이그레이션)이 필요
    - 그러나 대부분의 NoSQL 데이터베이스를 사용하면 수평적 확장이 가능하므로 필요할 때마다 더 저렴한 비용으로 상용서버 추가 가능
- #### 빠른 쿼리
    - 일반적으로 Join이 필요하지 않아 NoSQL 쿼리는 SQL 쿼리보다 빠를 수 있음
    - NoSQL 데이터베이스의 데이터는 일반적으로 쿼리에 최적화된 방식으로 저장됨
    - 경험에 의한 법칙은 함께 엑세스되는 데이터와 함께 저장되어야 함
- #### 사용하기 단순
    - 데이터 구조를 일반적인 프로그래밍언어의 데이터 구조에 매핑 -> 애플리케이션 코드에서 사용하는 것과 동일한 방식으로 데이터 저장
    - 개발자는 적은 코드를 작성하여 개발시간을 단축하고 버그를 줄일 수 있음
### NoSQL 단점
- #### ACID 트랜잭션을 지원하지 않음 
    - 적절한 스키마 디자인이 있다면 단일 레코드의 원자화는 가능하나 다수의 레코드에 ACID를 요구하는 애플리 케이션이 많음
    - 해당 유스케이스를 해결하기 위해 MongoDB는 ACID 트랜잭션 지원을 추가하고 4.2로 확장함으로 샤크 클러스터를 확장했다고 함
- #### 특정 NoSQL 타입에 따라 단일 데이터베이스에서 유스케이스를 실현하지 못할 수 있음
    - NoSQL 데이터베이스를 선택할 때 유스케이스를 고려해야 함
- #### 데이터 중복을 감수시키지 않음
    - NoSQL의 데이터베이스 모델은 일반적으로 쿼리에 최적화 되고 데이터 중복을 감소시키지 않아 SQL 데이터베이스보다 클 수 있음
    - 현재 스토리지가 저렴하여 사소한 단점이며 일부 NoSQL 데이터베이스는 스토리지 공간을 줄이기 위한 compression 을 지원

<br>

#### RDB vs NoSQL 정리

|비교|SQL DB|NoSQL DB|
|:---:|:---:|:---:|
|데이터 저장소 모델|고정 행과 열이 있는 테이블|document-JSON document, key value store-key value 쌍, wide column-row와 동적 column이 있는 테이블, graph db-노드 및 엣지|
|역사|데이터 복제 감소에 중점을 둔 1970년대에 개발|2000년대 후반에 애자일과 DevOps 관행에 따라 신속한 애플리케이션 변경의 가능과 확장성에 중점을 두고 개발|
|주요목적|범용|document-범용, key value store-간단한 조회 질의를 이용한 대량의 데이터 추출, wide column-예측 가능한 쿼리 패턴을 이용한 대량의 데이터 추출, graph db-연결된 데이터 간의 관계 분석 및 탐색|
|스키마|엄격|유연|
|확장(스케일링)|수직(더 큰 서버로 확장 포함)|수평(서버간 스케일 아웃)|
|ACID Transctions|지원|대부분 지원하지 않음|
|Join|일반적으로 필요|일반적으로 필요하지 않음|
|data-object Mapping|ORM|대부분 ORM을 요구하지 않음. MongoDB document는 가장 많이 사용되는 프로그래밍 언어로 데이터 구조에 직접 매핑|
|예|Oracle, MySQL, Microsoft SQL Serverm, PostgreSQL|Serverm, PostgreSQL, document-MongoDB/CouchDB, key value store-Redis/DynamoDB, wide column-Cassandra/HBase, graph db-Neo4j/Amazon Neptune|

<br>

### RDB, NoSQL 언제 사용하는 것이 좋은지
#### SQL 사용이 좋은 경우
- 관계를 맺고 있는 데이터가 자주 변경되는 애플리케이션의 경우
- 변경될 여지가 없고, 명확한 스키마가 사용자와 데이터에게 중요한 경우
#### NoSQL 사용이 좋은 경우
- 정확한 데이터 구조를 알 수 없거나 변경/확장 될 수 있는 경우
- 읽기 처리를 자주하지만, 데이터를 자주 변경하지 않는 경우 (한번의 변경으로 수십개의 문서를 업데이트할 필요가 있는 경우, NoSQL의 경우 여러 컬렉션을 모두 수정해 주어야 함)
- 데이터베이스를 수평으로 확장해야 하는 경우 (막대한 양의 데이터를 다뤄야 하는 경우)

<br>

### NoSQL 저장기술 형태
#### 1. Key-Value Database
- 데이터가 Key와 Value 쌍으로 저장됨
- Key 값은 어떠한 형태의 데이터라도 담을 수 있음. 이미지나 비디오도 가능
- 간단한 API를 제공하는 만큼 질의의 속도가 굉장히 빠름
- Redis, Riak, Amazon DB 등이 있음
#### 2. Document Database
- Key와 Document 형태로 저장
- 객체지향에서 객체와 유사하며 이들은 하나의 단위로 취급되어 저장됨
- 즉, 하나의 객체를 여러 테이블에 나눠 저장할 필요가 없음
- 주요 특징으로는 객체-관계 매핑이 필요하지 않음. 객체를 Document 형태로 바로 저장 가능 하기 때문
- 검색에 최적화되어 있음. 이유는 Key-value 특징과 동일
- 사용이 번거롭고 쿼리가 SQL문과 다름
- MongoDB, CouthDB 등이 있음
#### 3. Wide Colimn Database
- Colimn-family Model 기반의 Database
- 키에서 필드를 결정함. 키는 Row(키 값)와 Column-family, Column-name을 가짐. 연괸된 데이터들은 같은 Column-family 안에 속해 있으며 각자의 Column-name을 가짐
- 관계형 모델로 설명하면 어트리뷰트가 계층 구조를 가지고 있는 셈으로 이렇게 저장된 데이터는 하나의 커다란 테이블로 표현이 가능하며 질의는 Row, Column-family, Column-name을 통해 수행됨
- HBase, Hypertable 등이 있음
#### 4. Graph Database
- 데이터를 Node와 Edge, Propery와 함께 그래프 구조를 사용하여 데이터를 표현하고 저장하는 DB
- 개체와 관계를 그래프 형태로 표현한 것이므로 관계형 모델이라 할 수 있으며, 데이터 간의 관계가 탐색의 키일 경우 적합
- 페이스북이나 트위터 같은 소셜 네트워크에서 적합하고, 연관된 데이터를 추천해주는 추천 엔진이나 패턴 인식 등의 데이터베이스로도 적합
- Neo4J 등이 있음

<br>

<div style="text-align: right">22-08-01</div>
<div style="text-align: right"> + 내용추가 : 22-08-03</div>

-------

## Reference
- https://velog.io/@hanblueblue/번역-NoSQL-vs-Relational-Databases
- https://velog.io/@coding_egg/CS-Nosql이-수평확장Scale-Out에-유리한-이유
- https://velog.io/@eodyd6564/SQL과-NoSQL-MySQL과-MongoDB